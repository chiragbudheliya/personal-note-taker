<!DOCTYPE html>
<html>
<head>
  <title>Personal Note Taker</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
    textarea { width: 100%; height: 200px; margin-top: 10px; }
    button { margin-right: 10px; padding: 10px 15px; font-size: 16px; }
  </style>
</head>
<body>
  <h1>Personal Note Taker</h1>
  <button id="startBtn">Start Recording</button>
  <button id="pauseBtn" disabled>Pause Recording</button>
  <button id="stopBtn" disabled>Stop Recording</button>
  <button id="downloadBtn" disabled>Download Notes</button>
  <textarea id="transcript" placeholder="Your notes will appear here..." readonly></textarea>

  <script>
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const stopBtn = document.getElementById('stopBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const transcriptArea = document.getElementById('transcript');

    let recognition;
    let isRecording = false;
    let isPaused = false;

    if (!('webkitSpeechRecognition' in window)) {
      alert('Your browser does not support speech recognition. Please use Chrome.');
    } else {
      recognition = new webkitSpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = 'en-US';

      recognition.onresult = (event) => {
        let interimTranscript = '';
        for (let i = event.resultIndex; i < event.results.length; ++i) {
          if (event.results[i].isFinal) {
            transcriptArea.value += event.results[i][0].transcript + '\n';
          } else {
            interimTranscript += event.results[i][0].transcript;
          }
        }
      };

      recognition.onerror = (event) => {
        console.error('Speech recognition error', event.error);
      };

      recognition.onend = () => {
        if (isRecording && !isPaused) {
          recognition.start(); // auto-restart unless paused
        }
      };
    }

    startBtn.onclick = () => {
      if (!isRecording) {
        recognition.start();
        isRecording = true;
        isPaused = false;
        startBtn.disabled = true;
        pauseBtn.disabled = false;
        pauseBtn.textContent = 'Pause Recording';
        stopBtn.disabled = false;
        downloadBtn.disabled = true;
        transcriptArea.value = '';
      }
    };

    pauseBtn.onclick = () => {
      if (!isPaused) {
        recognition.stop();
        isPaused = true;
        pauseBtn.textContent = 'Resume Recording';
      } else {
        recognition.start();
        isPaused = false;
        pauseBtn.textContent = 'Pause Recording';
      }
    };

    stopBtn.onclick = () => {
      if (isRecording) {
        recognition.stop();
        isRecording = false;
        isPaused = false;
        startBtn.disabled = false;
        pauseBtn.disabled = true;
        stopBtn.disabled = true;
        downloadBtn.disabled = false;
        pauseBtn.textContent = 'Pause Recording';
      }
    };

    downloadBtn.onclick = () => {
      const blob = new Blob([transcriptArea.value], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'PersonalNoteTaker_Notes.txt';
      a.click();
      URL.revokeObjectURL(url);
    };
  </script>
</body>
</html>
